### Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰ ğŸ”„

é¢è¯•å®˜ï¼šè¯·è°ˆè°ˆ JavaScript çš„äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚

å›ç­”ï¼š
JavaScript æ˜¯ä¸€é—¨**å•çº¿ç¨‹**ä¸”**éé˜»å¡**çš„è„šæœ¬è¯­è¨€ã€‚è¿™ç§è®¾è®¡æºäºå…¶æœ€åˆä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€çš„å®šä½ï¼š

- **å•çº¿ç¨‹**ï¼šä»»ä½•æ—¶å€™åªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹æ‰§è¡Œä»»åŠ¡
- **éé˜»å¡**ï¼šé€šè¿‡äº‹ä»¶å¾ªç¯æœºåˆ¶å¤„ç†å¼‚æ­¥æ“ä½œ

### äº‹ä»¶å¾ªç¯çš„æ ¸å¿ƒæµç¨‹ï¼š

1. **æ‰§è¡ŒåŒæ­¥ä»»åŠ¡**  
   ä¸»çº¿ç¨‹é¡ºåºæ‰§è¡Œè°ƒç”¨æ ˆä¸­çš„åŒæ­¥ä»£ç 
2. **å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—**

   - æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼ˆ`Promise.then/catch/finallyã€queueMicrotaskã€MutationObserver`ï¼‰
   - é‡è¦ç‰¹æ€§ï¼š**å¾®ä»»åŠ¡ä¼šå®Œå…¨æ¸…ç©ºé˜Ÿåˆ—**ï¼ˆåŒ…æ‹¬æ‰§è¡Œè¿‡ç¨‹ä¸­æ–°äº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼‰

3. **æ‰§è¡Œæ¸²æŸ“ç›¸å…³æ“ä½œ**ï¼ˆå¦‚æœéœ€è¦æ¸²æŸ“ï¼‰

   - è§¦å‘`requestAnimationFrame`å›è°ƒ
   - æ‰§è¡Œé¡µé¢æ¸²æŸ“ï¼ˆæ ·å¼è®¡ç®—ã€å¸ƒå±€ã€ç»˜åˆ¶ï¼‰
   - æ³¨æ„ï¼šè¿™ä¸æ˜¯ç‹¬ç«‹çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ¸²æŸ“å‘¨æœŸçš„é’©å­

4. **ä»å®ä»»åŠ¡é˜Ÿåˆ—å–ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œ**

   - å–å‡ºæœ€è€çš„å®ä»»åŠ¡ï¼ˆ`setTimeoutã€setIntervalã€I/O æ“ä½œã€DOM äº‹ä»¶å›è°ƒã€æ•´ä½“ script ä»£ç `ï¼‰
   - é‡è¦è§„åˆ™ï¼š**æ¯æ¬¡å¾ªç¯åªæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡**

5. é‡å¤æ­¥éª¤ 1-4

### ç¤ºä¾‹ï¼š

```javascript
console.log("script start"); // å®ä»»åŠ¡1

setTimeout(() => console.log("setTimeout"), 0); // å®ä»»åŠ¡2

Promise.resolve().then(() => {
  console.log("promise");
  queueMicrotask(() => console.log("microtask in microtask"));
}); // å¾®ä»»åŠ¡

requestAnimationFrame(() => console.log("rAF")); // æ¸²æŸ“å›è°ƒ

console.log("script end"); // å®ä»»åŠ¡1ç»§ç»­
```

è¾“å‡ºé¡ºåºï¼š

1. script start â†’ script endï¼ˆå®ä»»åŠ¡ 1 åŒæ­¥ä»£ç ï¼‰
2. promise â†’ microtask in microtaskï¼ˆå¾®ä»»åŠ¡ï¼‰
3. rAFï¼ˆæ¸²æŸ“å›è°ƒï¼‰
4. setTimeoutï¼ˆå®ä»»åŠ¡ 2ï¼‰
